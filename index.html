<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoinTracker - ë¹„íŠ¸ì½”ì¸ ETF ë¹„êµ</title>
    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        body {
            font-family: 'Noto Sans KR', sans-serif;
            margin: 0;
            background-color: #121826;
            color: #E5ECF6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        a {
            color: #FFB800;
            text-decoration: none;
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start; /* ìƒë‹¨ ì •ë ¬ */
            padding: 10px 0;
            border-bottom: 1px solid #2a3f5f;
        }
        .logo-section {
            display: flex;
            flex-direction: column; /* ë¡œê³ ì™€ ì‹œê°„ì„ ì„¸ë¡œë¡œ ì •ë ¬ */
        }
        .logo {
            font-size: 24px;
            font-weight: bold;
        }
        .timestamp {
            font-size: 12px;
            color: #8c9db3;
            margin-top: 5px;
        }

        .header-metrics {
            display: flex;
            gap: 40px; /* ê°€ê²©ê³¼ ìœ ì…ëŸ‰ ì‚¬ì´ì˜ ê°„ê²© */
        }
        .live-btc-price, .live-etf-inflow {
            text-align: right;
        }
        .live-btc-price .price, .live-etf-inflow .total {
            font-size: 28px;
            font-weight: bold;
        }
        .live-btc-price .change, .live-etf-inflow .change {
            font-size: 16px;
        }

        /* ê³µí†µ ìƒìŠ¹/í•˜ë½ ìƒ‰ìƒ */
        .up { color: #4CAF50 !important; }
        .down { color: #F44336 !important; }
        
        /* ë©”ì¸ ëŒ€ì‹œë³´ë“œ ìŠ¤íƒ€ì¼ */
        .dashboard {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .main-chart-container, .etf-list-container {
            background-color: #1A2233;
            padding: 20px;
            border-radius: 8px;
        }
        h2 {
            margin-top: 0;
            border-bottom: 1px solid #2a3f5f;
            padding-bottom: 10px;
            font-weight: 500;
        }
        .main-chart-container {
            height: 400px;
        }

        /* ETF ë¦¬ìŠ¤íŠ¸ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .etf-table {
            width: 100%;
            border-collapse: collapse;
        }
        .etf-table th, .etf-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #2a3f5f;
        }
        .etf-table th {
            font-weight: 500;
        }
        .etf-table tbody tr:hover {
            background-color: #2a3f5f;
        }

        /* ì•„ì´ì½˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .icon-button-section {
            margin-top: 20px;
            text-align: center;
        }
        .graph-link-button {
            display: inline-block;
            background-color: #FFB800;
            color: #121826;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .graph-link-button:hover {
            background-color: #ffd466;
        }
        .graph-link-button .icon {
            margin-right: 10px;
            font-size: 24px;
            vertical-align: middle;
        }

        /* ë‰´ìŠ¤ ì„¹ì…˜ */
        .news-section {
            background-color: #1A2233;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .news-list {
            padding-left: 0;
        }
        .news-list li {
            padding: 10px 0;
            border-bottom: 1px solid #2a3f5f;
            list-style: none;
        }
        .news-list li:last-child {
            border-bottom: none;
        }
        .news-title {
            font-size: 16px;
        }
        .news-meta {
            font-size: 12px;
            color: #8c9db3;
        }

        /* í‘¸í„° */
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            border-top: 1px solid #2a3f5f;
            font-size: 14px;
            color: #8c9db3;
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <div class="logo-section">
                <div class="logo">
                    <a href="#">CoinTracker</a>
                </div>
                <div class="timestamp" id="timestamp-display">
                    Loading time...
                </div>
            </div>
            <div class="header-metrics">
                <div class="live-etf-inflow">
                    <div>Total ETF Net Inflow</div>
                    <div class="total" id="etf-inflow-total">Loading...</div>
                    <div class="change" id="etf-inflow-change"></div>
                </div>
                <div class="live-btc-price">
                    <div>Bitcoin Price</div>
                    <div class="price" id="btc-price">Loading...</div>
                    <div class="change" id="btc-change"></div>
                </div>
            </div>
        </header>

        <main>
            <div class="dashboard">
                <div class="main-chart-container">
                    <div class="tradingview-widget-container" style="height:100%;width:100%">
                      <div id="tradingview_f73f8" style="height:calc(100% - 32px);width:100%"></div>
                      <div class="tradingview-widget-copyright"><a href="https://kr.tradingview.com/" rel="noopener nofollow" target="_blank"><span class="blue-text">TradingViewì—ì„œ ëª¨ë“  ì‹œì¥ ì¶”ì </span></a></div>
                      <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
                      <script type="text/javascript">
                      new TradingView.widget(
                      {
                      "autosize": true,
                      "symbol": "BITSTAMP:BTCUSD",
                      "interval": "D",
                      "timezone": "Etc/UTC",
                      "theme": "dark",
                      "style": "1",
                      "locale": "ko",
                      "enable_publishing": false,
                      "allow_symbol_change": true,
                      "container_id": "tradingview_f73f8"
                    }
                      );
                      </script>
                    </div>
                </div>

                <div class="etf-list-container">
                    <h2>ì£¼ìš” í˜„ë¬¼ ETF</h2>
                    <table class="etf-table">
                        <thead>
                            <tr>
                                <th>í‹°ì»¤</th>
                                <th>ìš´ìš©ì‚¬</th>
                                <th>AUM</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>IBIT</td>
                                <td>BlackRock</td>
                                <td>$19.5B</td>
                            </tr>
                            <tr>
                                <td>FBTC</td>
                                <td>Fidelity</td>
                                <td>$11.2B</td>
                            </tr>
                            <tr>
                                <td>ARKB</td>
                                <td>ARK/21Shares</td>
                                <td>$4.6B</td>
                            </tr>
                            <tr>
                                <td>BITB</td>
                                <td>Bitwise</td>
                                <td>$4.4B</td>
                            </tr>
                             <tr>
                                <td>GBTC</td>
                                <td>Grayscale</td>
                                <td>$28.7B</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="icon-button-section">
                <a href="graph.html" class="graph-link-button" target="_blank">
                    <span class="icon">ğŸ“Š</span> BTC ê°€ê²© vs ETF ìœ ì…ëŸ‰ ìƒì„¸ ë¶„ì„
                </a>
            </div>

            <div class="news-section">
                <h2>ìµœì‹  ë‰´ìŠ¤</h2>
                <ul class="news-list">
                    <li>
                        <div class="news-title"><a href="#">ë¹„íŠ¸ì½”ì¸, ê¸°ê´€ íˆ¬ìì ìœ ì… ì¦ê°€ë¡œ 7ë§Œ ë‹¬ëŸ¬ ëŒíŒŒ ì‹œë„</a></div>
                        <div class="news-meta">ì½”ì¸ë‰´ìŠ¤ Â· 2ì‹œê°„ ì „</div>
                    </li>
                    <li>
                        <div class="news-title"><a href="#">ë¯¸ SEC, ì¶”ê°€ ë¹„íŠ¸ì½”ì¸ í˜„ë¬¼ ETF ìŠ¹ì¸ ì—¬ë¶€ ê²€í†  ì¤‘</a></div>
                        <div class="news-meta">ë¸”ë¡ì²´ì¸ íˆ¬ë°ì´ Â· 5ì‹œê°„ ì „</div>
                    </li>
                    <li>
                        <div class="news-title"><a href="#">ë¸”ë™ë¡ IBIT, ì¶œì‹œ 6ê°œì›” ë§Œì— ìµœëŒ€ ê·œëª¨ ETF ë“±ê·¹</a></div>
                        <div class="news-meta">ì›”ìŠ¤íŠ¸ë¦¬íŠ¸ ì €ë„ Â· 1ì¼ ì „</div>
                    </li>
                </ul>
            </div>
        </main>
        
        <footer>
            <p>&copy; 2024 CoinTracker. All rights reserved.</p>
            <p><a href="#">ì´ìš©ì•½ê´€</a> | <a href="#">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a></p>
        </footer>
    </div>
    
    <script>
        // DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
        const btcPriceElement = document.getElementById('btc-price');
        const btcChangeElement = document.getElementById('btc-change');
        const etfTotalElement = document.getElementById('etf-inflow-total');
        const etfChangeElement = document.getElementById('etf-inflow-change');
        const timestampElement = document.getElementById('timestamp-display');
        let lastPrice = 0;
        
        // 1. BTC ê°€ê²© ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
        async function fetchBtcPrice() {
            try {
                const response = await fetch('https://min-api.cryptocompare.com/data/pricemultifull?fsyms=BTC&tsyms=USD');
                const data = await response.json();
                const priceData = data.RAW.BTC.USD;
                const currentPrice = priceData.PRICE;
                const change24h = priceData.CHANGE24HOUR;
                const changePct24h = priceData.CHANGEPCT24HOUR;

                btcPriceElement.innerText = `$${currentPrice.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                
                const sign = change24h >= 0 ? '+' : '';
                btcChangeElement.innerText = `${sign}${change24h.toFixed(2)} (${sign}${changePct24h.toFixed(2)}%)`;
                
                btcPriceElement.classList.remove('up', 'down');
                if (currentPrice > lastPrice) btcPriceElement.classList.add('up');
                else if (currentPrice < lastPrice) btcPriceElement.classList.add('down');
                
                btcChangeElement.classList.remove('up', 'down');
                if (change24h >= 0) btcChangeElement.classList.add('up');
                else btcChangeElement.classList.add('down');
                
                lastPrice = currentPrice;
            } catch (error) {
                console.error('Error fetching Bitcoin price:', error);
                btcPriceElement.innerText = 'Error';
            }
        }

        // 2. ETF ì´ ìœ ì…ëŸ‰ í‘œì‹œ í•¨ìˆ˜ (Farside ë°ì´í„° ê¸°ì¤€ìœ¼ë¡œ ìˆ˜ì •)
        function displayEtfInflow() {
            // Farside ë°ì´í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì •í™•í•œ ìˆ˜ì¹˜ë¡œ ì—…ë°ì´íŠ¸í–ˆìŠµë‹ˆë‹¤.
            const cumulativeInflow = 54469000000; // $54,469 Million = $54.469 Billion
            const dailyInflow = -28600000;       // Farside ê¸°ì¤€ ìµœì‹  ì¼ì¼ ìœ ì¶œì… ì˜ˆì‹œ (-$28.6M)

            const formatLargeNumber = (num) => {
                if (Math.abs(num) >= 1.0e+9) return `$${(num / 1.0e+9).toFixed(2)}B`;
                if (Math.abs(num) >= 1.0e+6) return `$${(num / 1.0e+6).toFixed(2)}M`;
                return `$${num.toLocaleString()}`;
            };
            
            etfTotalElement.innerText = formatLargeNumber(cumulativeInflow);
            etfTotalElement.classList.toggle('up', cumulativeInflow >= 0);
            etfTotalElement.classList.toggle('down', cumulativeInflow < 0);
            
            const sign = dailyInflow >= 0 ? '+' : '';
            etfChangeElement.innerText = `${sign}${formatLargeNumber(dailyInflow)} (Daily)`;
            
            etfChangeElement.classList.toggle('up', dailyInflow >= 0);
            etfChangeElement.classList.toggle('down', dailyInflow < 0);
        }

        // 3. í˜„ì¬ ì‹œê°„ í‘œì‹œ í•¨ìˆ˜ (ë¯¸êµ­ ë™ë¶€ & í•œêµ­)
        function displayCurrentTime() {
            const now = new Date();
            const options = {
                year: 'numeric', month: '2-digit', day: '2-digit',
                hour: '2-digit', minute: '2-digit', second: '2-digit',
                hour12: true
            };
            const usEasternTime = now.toLocaleString('en-US', { ...options, timeZone: 'America/New_York' });
            const koreaTime = now.toLocaleString('ko-KR', { ...options, timeZone: 'Asia/Seoul' });
            timestampElement.innerHTML = `ğŸ‡ºğŸ‡¸ ${usEasternTime} (US Eastern)<br>ğŸ‡°ğŸ‡· ${koreaTime} (Korea)`;
        }

        // --- ì´ˆê¸° ì‹¤í–‰ ë° ì£¼ê¸°ì  ì—…ë°ì´íŠ¸ ì„¤ì • ---
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¦‰ì‹œ í•¨ìˆ˜ë“¤ì„ í˜¸ì¶œ
        fetchBtcPrice();
        displayEtfInflow();
        displayCurrentTime();

        // 1ì´ˆë§ˆë‹¤ ì‹œê°„ ì—…ë°ì´íŠ¸
        setInterval(displayCurrentTime, 1000);
        
        // 30ì´ˆë§ˆë‹¤ BTC ê°€ê²© ì—…ë°ì´íŠ¸
        setInterval(fetchBtcPrice, 30000);
    </script>
</body>
</html>